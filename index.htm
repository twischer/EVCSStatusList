<!DOCTYPE html>
<html>
<head>
<meta http-equiv="refresh" content="60">
<title>Electric Vehicle Charging Station Status List</title>
<script src="https://code.jquery.com/jquery-3.5.0.js"></script>
<script>
	const chargeAvailURL = "https://api.tomtom.com/search/2/chargingAvailability.json";
	const queryString = window.location.search;
	const urlParams = new URLSearchParams(queryString);
	const key = urlParams.get('key')
	const chargingAvailabilityIDs = urlParams.get('chargingAvailability').split(",")
	const requestNearBy = "https://api.tomtom.com/search/2/nearbySearch/.json?lat=52.347094948746346&lon=9.817606746711128&minPowerKW=1&key="
	const request = chargeAvailURL + "?key=" + key + "&chargingAvailability="

	$( document ).ready(function() {
		const today = new Date();
		const time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
		$("div").append("Last update from " + time);
		$.each(chargingAvailabilityIDs, function( index, id ) {
			const street = "test"
			$.getJSON(request+id, function(result) {
				var connector = result.connectors[0];
				$("div").append("<tr><td>"+street+"</td><td>" + connector.availability.current.available+"/"+connector.total + "</td><tr>");
			});
		});
	});
</script>
</head>
<body>
<h1>Electric Vehicle Charging Station Status List</h1>

<div></div>

</body>
</html>

